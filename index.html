<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday ❤️</title>

<style>
body {
  margin: 0;
  height: 100vh;
  overflow: hidden;
  background-color: #1a000a;
  font-family: 'Georgia', serif;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* START ELEMENT */
#ball {
  width: 120px;
  height: 120px;
  border: 1px solid rgba(255, 255, 255, 0.4);
  border-radius: 50%;
  position: absolute;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
  animation: slowPulse 3s infinite ease-in-out;
}

#ball span {
  color: #fff;
  font-size: 11px;
  letter-spacing: 2px;
  text-transform: uppercase;
}

@keyframes slowPulse {
  0%, 100% { transform: scale(1); opacity: 0.7; }
  50% { transform: scale(1.1); opacity: 1; }
}

/* CELEBRATION SECTION */
#celebration {
  position: fixed;
  inset: 0;
  opacity: 0;
  pointer-events: none;
  transition: opacity 2s ease;
  z-index: 50;
  background-color: #000;
}

#celebration.show {
  opacity: 1;
  pointer-events: auto;
}

.bg-layer {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: opacity 1.2s ease-in-out;
  z-index: -2;
}

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(2px);
  z-index: -1;
}

#content-container {
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

#content-wrap {
    width: 85%;
    max-width: 500px;
    text-align: center;
    z-index: 60;
    pointer-events: none;
}

#celebration h1 {
  font-size: clamp(28px, 8vw, 48px);
  color: #fff;
  margin-bottom: 20px;
  text-shadow: 0 2px 15px rgba(0,0,0,0.8);
}

#note {
  padding: 30px;
  color: #ffffff;
  font-size: clamp(15px, 4vw, 19px);
  line-height: 1.8;
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

#hint {
    position: absolute;
    bottom: 30px;
    color: white;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    opacity: 0.6;
}

.particle { position: absolute; pointer-events: none; z-index: 70; }
</style>
</head>

<body>

<audio id="player" loop></audio>

<div id="ball"><span>don't touch</span></div>

<div id="celebration">
  <img id="bg1" class="bg-layer" src="mylove1.jpeg" style="opacity: 1;">
  <img id="bg2" class="bg-layer" src="mylove2.jpeg" style="opacity: 0;">
  
  <div class="overlay"></div>

  <div id="content-container">
    <div id="content-wrap">
      <h1>Happy Birthday, Love</h1>
      <div id="note">
          To the soul that makes my world beautiful.<br><br>
          Every moment with you is a gift I cherish. May your day be as radiant and lovely as you are.<br><br>
          Stay wonderful, stay you.<br><br>
          <strong>Always & Forever. ❤️</strong>
      </div>
    </div>
    <div id="hint">Tap anywhere to change photo and song</div>
  </div>
</div>

<script>
const ball = document.getElementById("ball");
const celebration = document.getElementById("celebration");
const bg1 = document.getElementById("bg1");
const bg2 = document.getElementById("bg2");
const player = document.getElementById("player");

let count = 0;
let finished = false;
let currentIndex = 1;
const totalCount = 5;

// Initial Positioning
ball.style.left = "calc(50% - 60px)";
ball.style.top = "calc(50% - 60px)";

function moveBall() {
  if(finished) return;
  count++;
  
  // Browsers require a user gesture to play audio. 
  // We trigger the first song load on the first ball tap.
  if(count === 1) {
    player.src = `mylv${currentIndex}.mp3`;
    player.load();
  }

  if(count === 6) {
    finished = true;
    ball.style.opacity = "0";
    setTimeout(() => {
        ball.remove();
        celebration.classList.add("show");
        player.play(); // Start music when the card shows
    }, 800);
    return;
  }
  const x = Math.random() * (innerWidth - 150);
  const y = Math.random() * (innerHeight - 150);
  ball.style.left = x + "px";
  ball.style.top = y + "px";
}

ball.addEventListener("click", moveBall);

// Changing Background and Song on Click
celebration.addEventListener("click", (e) => {
    currentIndex++;
    if(currentIndex > totalCount) currentIndex = 1;
    
    // Update Image Source
    const nextImgSrc = `mylove${currentIndex}.jpeg`;
    
    // Update Song Source
    player.src = `mylv${currentIndex}.mp3`;
    player.play();

    // Smooth Transition Logic for Images
    if (parseFloat(bg1.style.opacity) === 1) {
        bg2.src = nextImgSrc;
        bg2.style.opacity = 1;
        bg1.style.opacity = 0;
    } else {
        bg1.src = nextImgSrc;
        bg1.style.opacity = 1;
        bg2.style.opacity = 0;
    }
    
    createAestheticExplosion(e.clientX, e.clientY);
});

function createAestheticExplosion(x, y) {
  const colors = ['#ffccd5', '#ffffff', '#ffb3c1'];
  const symbols = ['✧', '❤', '✦'];

  for(let i = 0; i < 30; i++) {
    const p = document.createElement("div");
    p.className = "particle";
    p.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
    p.style.left = x + "px";
    p.style.top = y + "px";
    p.style.color = colors[Math.floor(Math.random() * colors.length)];
    p.style.fontSize = "15px";

    const angle = Math.random() * Math.PI * 2;
    const velocity = 100 + Math.random() * 150; 

    p.animate([
      { transform: "translate(0, 0) scale(0)", opacity: 1 },
      { transform: `translate(${Math.cos(angle) * velocity}px, ${Math.sin(angle) * velocity}px) rotate(360deg)`, opacity: 0 }
    ], {
      duration: 3000,
      easing: "ease-out"
    });

    celebration.appendChild(p);
    setTimeout(() => p.remove(), 3000);
  }
}
</script>

</body>
</html>
